!function(){var t,e,r,o,a;function i(e){return'<tr data-id="'+e.id+'"><td class="servico">'+(e.servico||"")+'</td><td class="regex"><code>'+(e.regex||"")+'</code></td><td class="normalizar">'+(e.normalizar?"Sim":"Não")+'</td><td class="prioridade">'+(e.prioridade||"")+'</td><td class="ativo">'+(e.ativo?"Ativo":"Inativo")+'</td><td class="text-end action"><button class="btn btn-sm btn-soft-primary me-1 btn-edit">Editar</button><button class="btn btn-sm btn-soft-danger btn-del">Excluir</button></td></tr>'}function n(e){o&&(a.id.value=e&&e.id||"",a.servico.value=e&&e.servico||"",a.regex.value=e&&e.regex||"",a.normalizar.value=e&&e.normalizar?"true":"false",a.prioridade.value=e&&e.prioridade||100,a.ativo.value=e&&e.ativo?"true":"false",o.show())}function d(){fetch("http://localhost:3000/api/servicos/padroes").then(e=>e.json()).then(function(e){e&&e.rows?(t.innerHTML=e.rows.map(i).join(""),new List("padroesList",{valueNames:["servico","regex","normalizar","prioridade","ativo","action"],page:20,pagination:!0}),t.addEventListener("click",function(e){var t,r=e.target.closest("tr");r&&(t=r.getAttribute("data-id"),e.target.closest(".btn-edit")&&n({id:t,servico:r.querySelector(".servico").textContent.trim(),regex:r.querySelector(".regex").textContent.trim(),normalizar:"Sim"===r.querySelector(".normalizar").textContent.trim(),prioridade:parseInt(r.querySelector(".prioridade").textContent.trim()||"100",10),ativo:"Ativo"===r.querySelector(".ativo").textContent.trim()}),e.target.closest(".btn-del"))&&confirm("Excluir este padrão?")&&fetch("http://localhost:3000/api/servicos/padroes/"+t,{method:"DELETE"}).then(e=>e.json()).then(function(e){e&&e.ok&&d()})})):t.innerHTML=""})}"undefined"==typeof List?console.warn("List.js não carregado"):(t=document.getElementById("padroes-tbody"),e=document.getElementById("btnAdd"),r=document.getElementById("padraoModal"),o=r?new bootstrap.Modal(r):null,a={id:document.getElementById("padrao-id"),servico:document.getElementById("padrao-servico"),regex:document.getElementById("padrao-regex"),normalizar:document.getElementById("padrao-normalizar"),prioridade:document.getElementById("padrao-prioridade"),ativo:document.getElementById("padrao-ativo"),save:document.getElementById("padrao-save")},e&&e.addEventListener("click",function(){n(null)}),a.save&&a.save.addEventListener("click",function(){var e,t={servico:a.servico.value.trim(),regex:a.regex.value.trim(),normalizar:"true"===a.normalizar.value,prioridade:parseInt(a.prioridade.value||"100",10),ativo:"true"===a.ativo.value};t.servico&&t.regex?(e=a.id.value,fetch("http://localhost:3000/api/servicos/padroes"+(e?"/"+e:""),{method:e?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(function(e){e&&e.ok?(o.hide(),d()):alert(e&&e.error||"Falha ao salvar.")})):alert("Informe serviço e regex.")}),d())}();