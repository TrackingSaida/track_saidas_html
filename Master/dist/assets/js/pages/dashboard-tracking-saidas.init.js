!function(){function l(e){return e.toISOString().slice(0,10)}function s(e,t){for(var a=[],r=new Date(e);r<=t;)a.push(l(r)),r.setDate(r.getDate()+1);return a}function d(e,t,a){var r,a=function(t){let a=1779033703^t.length;for(let e=0;e<t.length;e++)a=(a=Math.imul(a^t.charCodeAt(e),3432918353))<<13|a>>>19;return function(){return a=Math.imul(a^a>>>16,2246822507),((a=Math.imul(a^a>>>13,3266489909))^a>>>16)>>>0}}(a)(),a=(r=a,function(){var e=r+=1831565813,e=Math.imul(e^e>>>15,1|e);return(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}());return Math.floor(a*(t-e+1))+e}const c=["Ana Souza","Carlos Lima","João Pedro","Maria Fernandes","Rafael Silva","Thiago Santos","Luiz Henrique","Priscila Medeiros","Guilherme A.","Beatriz Ramos"];var e=document.getElementById("chart-entregadores-ranking"),t=document.getElementById("chart-pedidos-diarios");const m=echarts.init(e,null,{renderer:"canvas"}),u=echarts.init(t,null,{renderer:"canvas"});let h="ambos";async function a(){a=15,(n=new Date).setHours(0,0,0,0),(r=new Date(n)).setDate(r.getDate()-(a-1));var e,t,{start:a,end:r}={start:r,end:n},n=l(a),o=l(r),n=(document.getElementById("ranking-period").textContent=`Período: ${n} a `+o,document.getElementById("diario-period").textContent=`Período: ${n} a `+o,function(e,t){e=s(new Date(e),new Date(t));const i=[];return e.forEach(o=>{c.forEach((t,e)=>{var a=o+"::"+t,r=Math.max(0,d(0,3,a+"S")),n=Math.max(0,d(0,2,a+"M"));for(let e=0;e<r;e++)i.push({data:o,origem:"shopee",entregador:t});for(let e=0;e<n;e++)i.push({data:o,origem:"mercado_livre",entregador:t})})}),i}(n,o)),{names:o,values:i}=function(e){var t={};for(const a of e)t[a.entregador]=(t[a.entregador]||0)+1;return{names:(e=Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,10)).map(e=>e[0]).reverse(),values:e.map(e=>e[1]).reverse()}}(n),o=(o=o,i=i,m.setOption({grid:{left:8,right:16,top:10,bottom:10,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"value"},yAxis:{type:"category",data:o},series:[{type:"bar",data:i,barWidth:"55%",label:{show:!0,position:"right"},itemStyle:{borderRadius:[0,6,6,0]}}]}),s(a,r)),{shopee:i,ml:a,total:r}=function(e,t){r=e=>e.data;const a=e.reduce((e,t)=>{return(e[r(t)]||=[]).push(t),e},{});var r;const n=t.map(e=>(a[e]||[]).filter(e=>"shopee"===e.origem).length),o=t.map(e=>(a[e]||[]).filter(e=>"mercado_livre"===e.origem).length);return e=t.map((e,t)=>n[t]+o[t]),{shopee:n,ml:o,total:e}}(n,o);n=o,o=i,i=a,a=r,r=h,e="ambos"===r||"shopee"===r,t="ambos"===r||"mercado_livre"===r,r="total"===r,u.setOption({grid:{left:8,right:16,top:20,bottom:40,containLabel:!0},tooltip:{trigger:"axis"},legend:{bottom:0},xAxis:{type:"category",data:n.map(e=>e.slice(5))},yAxis:{type:"value"},series:[{name:"Shopee",type:"line",smooth:!0,areaStyle:{},showSymbol:!1,lineStyle:{width:2},data:e?o:o.map(()=>null)},{name:"Mercado Livre",type:"line",smooth:!0,areaStyle:{},showSymbol:!1,lineStyle:{width:2},data:t?i:i.map(()=>null)},{name:"Total Geral",type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:3},data:r?a:a.map(()=>null)}]})}document.getElementById("btn-refresh-ranking")?.addEventListener("click",a),document.getElementById("btn-refresh-diario")?.addEventListener("click",a),document.querySelectorAll("[data-origem]")?.forEach(e=>{e.addEventListener("click",e=>{h=e.currentTarget.getAttribute("data-origem"),e.currentTarget.parentElement.querySelectorAll("button").forEach(e=>e.classList.remove("active")),e.currentTarget.classList.add("active"),a()})}),window.addEventListener("resize",()=>{m.resize(),u.resize()}),a()}();